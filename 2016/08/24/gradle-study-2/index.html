<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="gradle," />





  <link rel="alternate" href="/atom.xml" title="Alvin-一座小楼" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Groovy是什么Groovy是一种基于JVM（Java虚拟机）的敏捷开发语言，它结合了Python、Ruby和Smalltalk的许多强大的特性，Groovy 代码能够与 Java 代码很好地结合，也能用于扩展现有代码。由于其运行在 JVM 上的特性，Groovy 可以使用其他 Java 语言编写的库。">
<meta property="og:type" content="article">
<meta property="og:title" content="Gradle for Andoid 学习笔记(二):Groovy入门">
<meta property="og:url" content="http://czhzero.com/2016/08/24/gradle-study-2/index.html">
<meta property="og:site_name" content="Alvin-一座小楼">
<meta property="og:description" content="Groovy是什么Groovy是一种基于JVM（Java虚拟机）的敏捷开发语言，它结合了Python、Ruby和Smalltalk的许多强大的特性，Groovy 代码能够与 Java 代码很好地结合，也能用于扩展现有代码。由于其运行在 JVM 上的特性，Groovy 可以使用其他 Java 语言编写的库。">
<meta property="og:image" content="http://o7y1sf21i.bkt.clouddn.com/blog/011/20151021205159588.png">
<meta property="og:updated_time" content="2017-01-15T05:03:28.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Gradle for Andoid 学习笔记(二):Groovy入门">
<meta name="twitter:description" content="Groovy是什么Groovy是一种基于JVM（Java虚拟机）的敏捷开发语言，它结合了Python、Ruby和Smalltalk的许多强大的特性，Groovy 代码能够与 Java 代码很好地结合，也能用于扩展现有代码。由于其运行在 JVM 上的特性，Groovy 可以使用其他 Java 语言编写的库。">
<meta name="twitter:image" content="http://o7y1sf21i.bkt.clouddn.com/blog/011/20151021205159588.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '6289947422453925000',
      author: '一座小楼'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://czhzero.com/2016/08/24/gradle-study-2/"/>





  <title> Gradle for Andoid 学习笔记(二):Groovy入门 | Alvin-一座小楼 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?70ce034e45a712ab10da0f89af899b0c";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Alvin-一座小楼</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">Test</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://czhzero.com/2016/08/24/gradle-study-2/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Alvin-一座小楼">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/my_head.jpeg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Alvin-一座小楼">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Alvin-一座小楼" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Gradle for Andoid 学习笔记(二):Groovy入门
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-08-24T11:45:24+08:00">
                2016-08-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android/" itemprop="url" rel="index">
                    <span itemprop="name">Android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/08/24/gradle-study-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/24/gradle-study-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/08/24/gradle-study-2/" class="leancloud_visitors" data-flag-title="Gradle for Andoid 学习笔记(二):Groovy入门">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Groovy是什么"><a href="#Groovy是什么" class="headerlink" title="Groovy是什么"></a>Groovy是什么</h2><p>Groovy是一种基于JVM（Java虚拟机）的敏捷开发语言，它结合了Python、Ruby和Smalltalk的许多强大的特性，Groovy 代码能够与 Java 代码很好地结合，也能用于扩展现有代码。由于其运行在 JVM 上的特性，Groovy 可以使用其他 Java 语言编写的库。</p>
<p><img src="http://o7y1sf21i.bkt.clouddn.com/blog/011/20151021205159588.png" alt="Gradle for Andoid"></p>
<a id="more"></a>
<p>下面四种方式都会输出“hello world”，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">System.out.println(&quot;hello world&quot;);</span><br><span class="line">System.out.println &quot;hello world&quot;;</span><br><span class="line"></span><br><span class="line">println(&quot;hello world&quot;)</span><br><span class="line">println &quot;hello world&quot;</span><br></pre></td></tr></table></figure>
<p>Groovy 语法与Java 语言的语法很相似，语法也比较灵活，例如上面一段代码，括号与分号，可有可无。</p>
<p>Groovy编写的文件扩展名是.groovy，学习Groovy官网是 <a href="http://groovy-lang.org" target="_blank" rel="external">http://groovy-lang.org</a>，<br>当然了做Android开发的人员可以直接用Gradle构建工具来运行Groovy，这时候扩展名是.gradle。</p>
<h2 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h2><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><p>与Java的注释语法相同，如：//注释 /<em> 注释 </em>/ /<em>* 注释 </em>/ 都支持,唯一不同的是，Groovy支持像Shell脚本那样的首行附加注释</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env groovy</span><br><span class="line"></span><br><span class="line">//注释1</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * 注释2</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">/* 注释3 */</span><br><span class="line"></span><br><span class="line">def x=1</span><br></pre></td></tr></table></figure>
<p>“#!”注释只允许在脚本文件的第一行出现，通过这种方式 Unix shell能定位groovy 的启动脚本并且运行这些脚本。</p>
<h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3><p>下面列表表示了Groovy语言所有的关键字, 代表意思与其他语言一致</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">as              assert           break               case</span><br><span class="line">catch           class            const               continue</span><br><span class="line">def             default          do                  else</span><br><span class="line">enum            extends          false               finally</span><br><span class="line">for             goto             if                  implements</span><br><span class="line">import          in               instanceof          interface</span><br><span class="line">new             null             package             return</span><br><span class="line">super           switch           this                throw</span><br><span class="line">throws          trait            true                try</span><br><span class="line">while</span><br></pre></td></tr></table></figure>
<h3 id="标识符"><a href="#标识符" class="headerlink" title="标识符"></a>标识符</h3><h4 id="正常标识符"><a href="#正常标识符" class="headerlink" title="正常标识符"></a>正常标识符</h4><p>标识符以字母，美元符号或下划线开始。不能以一个数字开始。<br>一个字母可以在以下范围：</p>
<ul>
<li>‘a’ 至 ‘z’ (小写ascii字母)</li>
<li>‘A’ 至 ‘Z’ (大写ascii字母)</li>
<li>‘\u00C0′ 至 ‘\u00D6′</li>
<li>‘\u00D8′ 至 ‘\u00F6′</li>
<li>‘\u00F8′ 至 ‘\u00FF’</li>
<li>‘\u0100′ 至 ‘\uFFFE’</li>
</ul>
<p>后面的字符可以包括字母和数字。<br>这里是一些合法标识符的示例（这里是变量名称）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def name</span><br><span class="line">def item3</span><br><span class="line">def with_underscore</span><br><span class="line">def $dollarStart</span><br></pre></td></tr></table></figure>
<p>但是以下面展示了一些非法的标识符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">def 3tier</span><br><span class="line">def a+b</span><br><span class="line">def a#b</span><br></pre></td></tr></table></figure>
<p>当在一个点后，所有的关键字也是合法的标识符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foo.as</span><br><span class="line">foo.assert</span><br><span class="line">foo.break</span><br><span class="line">foo.case</span><br><span class="line">foo.catch</span><br></pre></td></tr></table></figure>
<h4 id="引用标识符"><a href="#引用标识符" class="headerlink" title="引用标识符"></a>引用标识符</h4><p>引用标识符出现在一个点式表达式的点后面。例如，person.name表达式中的name，能通过person.”name”,person.’name’被引用。当某些标识符包含有Java语言规范禁止的非法字符，这是相当有趣的，但被Groovy引用所允许。例如，像一个破折号，一个空格，一个感叹号等。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def map = [:]</span><br><span class="line"></span><br><span class="line">map.&quot;an identifier with a space and double quotes&quot; = &quot;ALLOWED&quot;</span><br><span class="line">map.&apos;with-dash-signs-and-single-quotes&apos; = &quot;ALLOWED&quot;</span><br><span class="line"></span><br><span class="line">assert map.&quot;an identifier with a space and double quotes&quot; == &quot;ALLOWED&quot;</span><br><span class="line">assert map.&apos;with-dash-signs-and-single-quotes&apos; == &quot;ALLOWED&quot;</span><br></pre></td></tr></table></figure>
<p>正如我们将在字符串章节看到的，Groovy提供了不同的字符串字面量。所有不同类型的字符串都被允许出现在点后面：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">map.&apos;single quote&apos;</span><br><span class="line">map.&quot;double quote&quot;</span><br><span class="line">map.&apos;&apos;&apos;triple single quote&apos;&apos;&apos;</span><br><span class="line">map.&quot;&quot;&quot;triple double quote&quot;&quot;&quot;</span><br><span class="line">map./slashy string/</span><br><span class="line">map.$/dollar slashy string/$</span><br></pre></td></tr></table></figure>
<p>普通字符串和Groovy的GStrings有一些不同（有插值的字符串），正如在后者的情况下，插入的值被插入到最后的字符串中，以计算整个标识符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def firstname = &quot;Homer&quot;</span><br><span class="line">map.&quot;Simson-$&#123;firstname&#125;&quot; = &quot;Homer Simson&quot;</span><br><span class="line"></span><br><span class="line">assert map.&apos;Simson-Homer&apos; == &quot;Homer Simson&quot;</span><br></pre></td></tr></table></figure>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><p>文本文字以字符链的形式表示被称作字符串。Groovy可以让你实例化java.lang.String对象，也可以实例化GString(groovy.lang.GString)，在其他编程语言中被称为插值字符串。</p>
<h4 id="单引号字符串"><a href="#单引号字符串" class="headerlink" title="单引号字符串"></a>单引号字符串</h4><p>单引号字符串是一系列被单引号包围的字符。</p>
<p>单引号字符串是普通的java.lang.String，不支持插值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;a single quoted string&apos;</span><br></pre></td></tr></table></figure>
<h4 id="字符串连接"><a href="#字符串连接" class="headerlink" title="字符串连接"></a>字符串连接</h4><p>所有Groovy字符串能使用+操作符连接：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert &apos;ab&apos; == &apos;a&apos; + &apos;b&apos;</span><br></pre></td></tr></table></figure>
<h4 id="三单引号字符串"><a href="#三单引号字符串" class="headerlink" title="三单引号字符串"></a>三单引号字符串</h4><p>三单引号字符串是一列被三个单引号包围的字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;a triple single quoted string&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<p>三单引号字符串是普通的java.lang.String，不支持插值。</p>
<p>三单引号字符串是多行的。你可以使字符串内容跨越行边界，不需要将字符串分割为一些片段，不需要连接，或换行转义符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def aMultilineString = &apos;&apos;&apos;line one</span><br><span class="line">line two</span><br><span class="line">line three&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<p>如果你的代码是缩进的，如类中的方法体，字符串将包括缩进的空格。Groovy开发工具包含一些剥离缩进的方法，使用String#stripIndent()方法，并使用String#stripMargin()方法，需要一个分隔符来识别文本从一个字符串的开始删除。<br>当创建一个如下字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def startingAndEndingWithANewline = &apos;&apos;&apos;</span><br><span class="line">line one</span><br><span class="line">line two</span><br><span class="line">line three</span><br><span class="line">&apos;&apos;&apos;</span><br></pre></td></tr></table></figure>
<h5 id="转义特殊字符"><a href="#转义特殊字符" class="headerlink" title="转义特殊字符"></a>转义特殊字符</h5><p>你可以使用反斜杠字符转义单引号，避免终止字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;an escaped single quote: \&apos; needs a backslash&apos;</span><br></pre></td></tr></table></figure>
<p>你能使用双反斜杠来转义转义字符自身：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;an escaped escape character: \\ needs a double backslash&apos;</span><br></pre></td></tr></table></figure>
<p>一些特殊字符使用反斜杠作为转义字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">转义序列    字符</span><br><span class="line">&apos;\t&apos;        tabulation</span><br><span class="line">&apos;\b&apos;        backspace</span><br><span class="line">&apos;\n&apos;        newline</span><br><span class="line">&apos;\r&apos;        carriage return</span><br><span class="line">&apos;\f&apos;        formfeed</span><br><span class="line">&apos;\\&apos;        backslash</span><br><span class="line">&apos;\&apos;&apos;        single quote (for single quoted and triple single quoted strings)</span><br><span class="line">&apos;\&quot;&apos;        double quote (for double quoted and triple double quoted strings)</span><br></pre></td></tr></table></figure>
<h5 id="Unicode转义序列"><a href="#Unicode转义序列" class="headerlink" title="Unicode转义序列"></a>Unicode转义序列</h5><p>对于那些键盘不能表示的字符，你能使用Unicode转义序列：一个反斜杠，后面跟着‘u’,然后是4个十六进制的数字。<br>例如，欧元货币标志可以使用这个表示：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&apos;The Euro currency symbol: \u20AC&apos;</span><br></pre></td></tr></table></figure>
<h4 id="双引号字符串"><a href="#双引号字符串" class="headerlink" title="双引号字符串"></a>双引号字符串</h4><p>双引号字符串是一些列被双引号包围的字符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;a double quoted string&quot;</span><br></pre></td></tr></table></figure>
<p>如果没有插值表达式，双引号字符串是普通的java.lang.String，如果插值存在则是groocy.lang.GString实例。<br>为了转义一个双引号，你能使用反斜杠字符：”A double quote: \””。</p>
<h5 id="字符串插值"><a href="#字符串插值" class="headerlink" title="字符串插值"></a>字符串插值</h5><p>任何Groovy表达式可以在所有字符文本进行插值，除了单引号和三单引号字符串。插值是使用占位符上的字符串计算值替换占位符的操作。占位符表达式是被${}包围，或前缀为$的表达式。当GString被传递给一个带有一个String参数的方法时，占位符的表达式被计算值，并通过调用表达式的toString()方法以字符串形式表示。<br>这里是一个占位符引用局部变量的字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def name = &apos;Guillaume&apos; // a plain string</span><br><span class="line">def greeting = &quot;Hello $&#123;name&#125;&quot;</span><br><span class="line"></span><br><span class="line">assert greeting.toString() == &apos;Hello Guillaume&apos;</span><br></pre></td></tr></table></figure>
<p>而且任何Groovy表达式是合法的，正如我们在示例中使用算数表达式所见一样:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def sum = &quot;The sum of 2 and 3 equals $&#123;2 + 3&#125;&quot;</span><br><span class="line">assert sum.toString() == &apos;The sum of 2 and 3 equals 5&apos;</span><br></pre></td></tr></table></figure>
<p>不仅任何表达式，实际上也允许${}占位符。语句也是被允许的，但一个语句等效于null。如果有多个语句插入占位符，那么最后一个语句应该返回一个有意义的值被插入占位符。例如，”The sum of 1 and 2 is equal to ${def a = 1; def b = 2; a + b}”字符串是被支持的，也能如预期一样工作，但一个好的实践是在GString占位符插入一个简单的表达式。</p>
<p>除了${}占位符以外，也可以使用$作为表达式前缀：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def person = [name: &apos;Guillaume&apos;, age: 36]</span><br><span class="line">assert &quot;$person.name is $person.age years old&quot; == &apos;Guillaume is 36 years old&apos;</span><br></pre></td></tr></table></figure>
<p>但只有a.b，a.b.c等形式的前缀表达式是合法的，而包含如方法调用的圆括号，闭包的花括号，算术操作符是非法的。给出如下数值变量定义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def number = 3.14</span><br></pre></td></tr></table></figure>
<p>如下语句将会抛出groovy.lang.MissingPropertyException，因为Groovy相信你在尝试访问一个不存在数字的toString属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shouldFail(MissingPropertyException) &#123;</span><br><span class="line">  println &quot;$number.toString()&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>你可以把”$number.toString()”用解释器解释为”${number.toString}()”。<br>如果在GString中你需要转义$或${}占位符，使它们不出现插值，那么你只需要使用反斜杠字符转义美元符号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert &apos;$&#123;name&#125;&apos; == &quot;\$&#123;name&#125;&quot;</span><br></pre></td></tr></table></figure>
<h4 id="插入闭包表达式的特殊情况"><a href="#插入闭包表达式的特殊情况" class="headerlink" title="插入闭包表达式的特殊情况"></a>插入闭包表达式的特殊情况</h4><p>到目前为止，我们仅仅看到在${}占位符中插入任意表达式，但一个闭包表达式标记的特殊情况。当占位符包括一个箭头，${-&gt;}，这表达式实际是一个闭包表达式，你可以把它看做一个前面紧靠美元符号的闭包：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def sParameterLessClosure = &quot;1 + 2 == $&#123;-&gt; 3&#125;&quot; （1）</span><br><span class="line">assert sParameterLessClosure == &apos;1 + 2 == 3&apos;</span><br><span class="line"></span><br><span class="line">def sOneParamClosure = &quot;1 + 2 == $&#123; w -&gt; w &lt;&lt; 3&#125;&quot; （2）</span><br><span class="line">assert sOneParamClosure == &apos;1 + 2 == 3&apos;</span><br></pre></td></tr></table></figure>
<p>（1）这是一个不携带参数的无参闭包<br>（2）这里的闭包携带一个java.io.StringWrite参数，你能使用&lt;&lt;追加内容。在这两处，占位符被嵌入闭包。</p>
<p>在外观上，定义一个表达式被插入看着有一些冗长，但闭包相比表达式有一个有趣的优势：延迟计算。<br>让我们思考如下示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def number = 1 （1）</span><br><span class="line">def eagerGString = &quot;value == $&#123;number&#125;&quot;</span><br><span class="line">def lazyGString = &quot;value == $&#123; -&gt; number &#125;&quot;</span><br><span class="line"></span><br><span class="line">assert eagerGString == &quot;value == 1&quot; （2）</span><br><span class="line">assert lazyGString == &quot;value == 1&quot; （3）</span><br><span class="line"></span><br><span class="line">number = 2 （4）</span><br><span class="line">assert eagerGString == &quot;value == 1&quot; （5）</span><br><span class="line">assert lazyGString == &quot;value == 2&quot; （6）</span><br></pre></td></tr></table></figure>
<p>（1）我们定义一个包含1的number变量，然后插入两个GString之中，在eagerGString中作为表达式，在lazyGString中作为闭包。<br>（2）我们期望对于eagerGString得到的结果字符串是包含1的相同字符串<br>（3）lazyGString相似<br>（4）然后给变量赋一个新值<br>（5）使用纯插值表达式，这值在GString创建时结合<br>（6）但使用闭包表达式，GString被强转为Sring时，闭包被调用，并产生包含新数值的更新字符串。<br>一个嵌入的闭包表达式，携带超过一个参数，那么在运行时将会产生一个异常。闭包仅仅允许携带0个或1个参数。</p>
<h4 id="与Java的互操作性"><a href="#与Java的互操作性" class="headerlink" title="与Java的互操作性"></a>与Java的互操作性</h4><p>当一个方法（无论是在Java或是Groovy中实现）预期需要一个java.lang.String，而我们传递了一个groovy.lang.GString实例，GString的toString()方法将会被自动透明的调用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">String takeString(String message) &#123; （4）</span><br><span class="line">  assert message instanceof String （5）</span><br><span class="line">  return message</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">def message = &quot;The message is $&#123;&apos;hello&apos;&#125;&quot; （1）</span><br><span class="line">assert message instanceof GString （2）</span><br><span class="line"></span><br><span class="line">def result = takeString(message) （3）</span><br><span class="line">assert result instanceof String</span><br><span class="line">assert result == &apos;The message is hello&apos;</span><br></pre></td></tr></table></figure>
<p>（1）我们创建一个GSring变量<br>（2）我们仔细检查GString实例<br>（3）我们将GString传递个一个携带String参数的方法<br>（4）takeString()明确说明它的唯一参数是一个String<br>（5）我们也验证一个参数是String而不是GString</p>
<h4 id="GString和String的hashCode"><a href="#GString和String的hashCode" class="headerlink" title="GString和String的hashCode"></a>GString和String的hashCode</h4><p>虽然插值字符串可以代替普通Java字符串，它们用一种不同的方式是字符串不同：它们的hashCode是不同的。普通Java字符串是不可变的，而一个GString依赖于插入的值，它的String是可变的。即使有相同的字符串结果，GString和String也没有相同的hashCode。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert &quot;one: $&#123;1&#125;&quot;.hashCode() != &quot;one: 1&quot;.hashCode()</span><br></pre></td></tr></table></figure>
<p>GString和String有不同的hashCode值，应该避免使用GSring作为Map的键值，我们使用String代替GString取出一个关联值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def key = &quot;a&quot;</span><br><span class="line">def m = [&quot;$&#123;key&#125;&quot;: &quot;letter $&#123;key&#125;&quot;] （1）</span><br><span class="line"></span><br><span class="line">assert m[&quot;a&quot;] == null （2）</span><br></pre></td></tr></table></figure>
<p>（1）map被一个初始化键值对创建，其键值是GString<br>（2）当我们尝试使用String键值获取值时，我们并没获取对应值，因为String和GString有不同的hashCode</p>
<h3 id="三双引号字符串"><a href="#三双引号字符串" class="headerlink" title="三双引号字符串"></a>三双引号字符串</h3><p>三双引号字符串与双引号字符串相同，增加多行，像三单引号字符串一样。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def name = &apos;Groovy&apos;</span><br><span class="line">def template = &quot;&quot;&quot;</span><br><span class="line">  Dear Mr $&#123;name&#125;,</span><br><span class="line"></span><br><span class="line">  You&apos;re the winner of the lottery!</span><br><span class="line"></span><br><span class="line">  Yours sincerly,</span><br><span class="line"></span><br><span class="line">  Dave</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">assert template.toString().contains(&apos;Groovy&apos;)</span><br></pre></td></tr></table></figure>
<p>无论是双引号还是单引号，在三双引号字符串中需要被转义。</p>
<h3 id="斜杠字符串"><a href="#斜杠字符串" class="headerlink" title="斜杠字符串"></a>斜杠字符串</h3><p>除了通常的带引号字符串，groovy提供斜杠字符串，使用/作为分隔符。斜杠字符串对于定义正则表达式和模式是特别有用的，因为不需要转义反斜杠。</p>
<p>一个斜杠字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def fooPattern = /.*foo.*/</span><br><span class="line">assert fooPattern == &apos;.*foo.*&apos;</span><br></pre></td></tr></table></figure>
<p>只有正斜杠需要反斜杠转义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def escapeSlash = /The character \/ is a forward slash/</span><br><span class="line">assert escapeSlash == &apos;The character / is a forward slash&apos;</span><br></pre></td></tr></table></figure>
<p>斜杠字符串是多行的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">def multilineSlashy = /one</span><br><span class="line">two</span><br><span class="line">three/</span><br><span class="line"></span><br><span class="line">assert multilineSlashy.contains(&apos;\n&apos;)</span><br></pre></td></tr></table></figure>
<p>斜杠字符串也能被插值（如，GString）:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def color = &apos;blue&apos;</span><br><span class="line">def interpolatedSlashy = /a $&#123;color&#125; car/</span><br><span class="line"></span><br><span class="line">assert interpolatedSlashy == &apos;a blue car&apos;</span><br></pre></td></tr></table></figure>
<p>有几个陷阱需要注意：<br>一个空的斜杠字符串不能使用双正斜杠表示，因为它被Groovy解析器作为一个单行注释理解。这就是为什么以下断言实际上无法编译，因为它看起来像一个无终止的语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert &apos;&apos; == //</span><br></pre></td></tr></table></figure>
<h4 id="美元符修饰的斜杠字符串"><a href="#美元符修饰的斜杠字符串" class="headerlink" title="美元符修饰的斜杠字符串"></a>美元符修饰的斜杠字符串</h4><p>美元符斜杠字符串是一个有开口$/和闭口$/界定的多行GString。这转义字符是美元符，它能转义另一个美元符，或一个正斜杠。但是双美元符和双正斜杠不用被转义，除了转义像GString占位符序列开始的字符串子序列的美元符，或者你需要转义一个序列，开头看着像闭包美元符斜杠字符串分隔符。</p>
<p>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">def name = &quot;Guillaume&quot;</span><br><span class="line">def date = &quot;April, 1st&quot;</span><br><span class="line"></span><br><span class="line">def dollarSlashy = $/</span><br><span class="line">  Hello $name,</span><br><span class="line">  today we&apos;re $&#123;date&#125;.</span><br><span class="line"></span><br><span class="line">  $ dollar sign</span><br><span class="line">  $$ escaped dollar sign</span><br><span class="line">  \ backslash</span><br><span class="line">  / forward slash</span><br><span class="line">  $/ escaped forward slash</span><br><span class="line">  $/$ escaped dollar slashy string delimiter</span><br><span class="line">/$</span><br><span class="line"></span><br><span class="line">assert [</span><br><span class="line">  &apos;Guillaume&apos;,</span><br><span class="line">  &apos;April, 1st&apos;,</span><br><span class="line">  &apos;$ dollar sign&apos;,</span><br><span class="line">  &apos;$ escaped dollar sign&apos;,</span><br><span class="line">  &apos;\\ backslash&apos;,</span><br><span class="line">  &apos;/ forward slash&apos;,</span><br><span class="line">  &apos;$/ escaped forward slash&apos;,</span><br><span class="line">  &apos;/$ escaped dollar slashy string delimiter&apos;</span><br><span class="line"></span><br><span class="line">].each &#123; dollarSlashy.contains(it) &#125;</span><br></pre></td></tr></table></figure>
<h4 id="字符串总结表"><a href="#字符串总结表" class="headerlink" title="字符串总结表"></a>字符串总结表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String name              String syntax     Interpolated     Multiline    Escape character</span><br><span class="line">Single quoted            &apos;…​&apos;                                              \</span><br><span class="line">Triple single quoted     &apos;&apos;&apos;…​&apos;&apos;&apos;                            是            \</span><br><span class="line">Double quoted            &quot;…​&quot;               是                             \</span><br><span class="line">Triple double quoted     &quot;&quot;&quot;…​&quot;&quot;&quot;           是               是            \</span><br><span class="line">slashy                   /…​/               是               是            \</span><br><span class="line">Dollar                   $/…​/$             是               是            \</span><br></pre></td></tr></table></figure>
<h4 id="字符"><a href="#字符" class="headerlink" title="字符"></a>字符</h4><p>与Java不同，Groovy没有显式的字符文本，然而你可以通过三种不同方式，可以将Groovy字符串实际作为一个字符使用。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">char c1 = &apos;A&apos; （1）</span><br><span class="line">assert c1 instanceof Character</span><br><span class="line"></span><br><span class="line">def c2 = &apos;B&apos; as char （2）</span><br><span class="line">assert c2 instanceof Character</span><br><span class="line"></span><br><span class="line">def c3 = (char)&apos;C&apos; （3）</span><br><span class="line">assert c3 instanceof Character</span><br></pre></td></tr></table></figure>
<p>1）当定义变量时，通过指定char类型，使变量包含字符<br>（2）通过as操作符使用类型强制转换<br>（3）通过char操作符做类型转换<br>第一个选项是（1）有趣的当一个字符在一个变量中，而另外两个（2和3）是更令人关注时char值必须作为一个方法调用的参数。</p>
<h3 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h3><p>Groovy支持不同类型的整数和小数，通常以Java的Number类型返回。</p>
<h4 id="整数"><a href="#整数" class="headerlink" title="整数"></a>整数</h4><p>整数类型与Java相同：</p>
<ul>
<li>byte</li>
<li>char</li>
<li>short</li>
<li>int</li>
<li>long</li>
<li>java.lang.BigInteger</li>
</ul>
<p>你能以如下定义创建这些类型的整数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// primitive types</span><br><span class="line">byte b = 1</span><br><span class="line">char c = 2</span><br><span class="line">short s = 3</span><br><span class="line">int i = 4</span><br><span class="line">long l = 5</span><br><span class="line"></span><br><span class="line">// infinite precision</span><br><span class="line">BigInteger bi = 6</span><br></pre></td></tr></table></figure>
<p>如果你通过使用def关键字使用可选类型，那么整数的类型将是可变的：它取决于这个类型实际包含的值。</p>
<p>对于正数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">def a = 1</span><br><span class="line">assert a instanceof Integer</span><br><span class="line"></span><br><span class="line">// Integer.MAX_VALUE</span><br><span class="line">def b = 2147483647</span><br><span class="line">assert b instanceof Integer</span><br><span class="line"></span><br><span class="line">// Integer.MAX_VALUE + 1</span><br><span class="line">def c = 2147483648</span><br><span class="line">assert c instanceof Long</span><br><span class="line"></span><br><span class="line">// Long.MAX_VALUE</span><br><span class="line">def d = 9223372036854775807</span><br><span class="line">assert d instanceof Long</span><br><span class="line"></span><br><span class="line">// Long.MAX_VALUE + 1</span><br><span class="line">def e = 9223372036854775808</span><br><span class="line">assert e instanceof BigInteger</span><br></pre></td></tr></table></figure>
<p>对于负数也一样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">def na = -1</span><br><span class="line">assert na instanceof Integer</span><br><span class="line"></span><br><span class="line">// Integer.MIN_VALUE</span><br><span class="line">def nb = -2147483648</span><br><span class="line">assert nb instanceof Integer</span><br><span class="line"></span><br><span class="line">// Integer.MIN_VALUE - 1</span><br><span class="line">def nc = -2147483649</span><br><span class="line">assert nc instanceof Long</span><br><span class="line"></span><br><span class="line">// Long.MIN_VALUE</span><br><span class="line">def nd = -9223372036854775808</span><br><span class="line">assert nd instanceof Long</span><br><span class="line"></span><br><span class="line">// Long.MIN_VALUE - 1</span><br><span class="line">def ne = -9223372036854775809</span><br><span class="line">assert ne instanceof BigInteger</span><br></pre></td></tr></table></figure>
<h5 id="可选择的非十进制表示"><a href="#可选择的非十进制表示" class="headerlink" title="可选择的非十进制表示"></a>可选择的非十进制表示</h5><p>二进制数</p>
<p>在Java6及以前和Groovy一样，数字只能使用十进制，八进制和十六进制表示，使用Java7和Groovy2你能使用0b前缀作为一个二进制符号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">int xInt = 0b10101111</span><br><span class="line">assert xInt == 175</span><br><span class="line"></span><br><span class="line">short xShort = 0b11001001</span><br><span class="line">assert xShort == 201 as short</span><br><span class="line"></span><br><span class="line">byte xByte = 0b11</span><br><span class="line">assert xByte == 3 as byte</span><br><span class="line"></span><br><span class="line">long xLong = 0b101101101101</span><br><span class="line">assert xLong == 2925l</span><br><span class="line"></span><br><span class="line">BigInteger xBigInteger = 0b111100100001</span><br><span class="line">assert xBigInteger == 3873g</span><br><span class="line"></span><br><span class="line">int xNegativeInt = -0b10101111</span><br><span class="line">assert xNegativeInt == -175</span><br></pre></td></tr></table></figure>
<p>八进制数</p>
<p>八进制数使用0后面跟八进制数的典型格式表示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">int xInt = 077</span><br><span class="line">assert xInt == 63</span><br><span class="line"></span><br><span class="line">short xShort = 011</span><br><span class="line">assert xShort == 9 as short</span><br><span class="line"></span><br><span class="line">byte xByte = 032</span><br><span class="line">assert xByte == 26 as byte</span><br><span class="line"></span><br><span class="line">long xLong = 0246</span><br><span class="line">assert xLong == 166l</span><br><span class="line"></span><br><span class="line">BigInteger xBigInteger = 01111</span><br><span class="line">assert xBigInteger == 585g</span><br><span class="line"></span><br><span class="line">int xNegativeInt = -077</span><br><span class="line">assert xNegativeInt == -63</span><br></pre></td></tr></table></figure>
<p>十六进制数</p>
<p>十六进制数使用0x后面跟十六进制数的典型格式表示。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">int xInt = 0x77</span><br><span class="line">assert xInt == 119</span><br><span class="line"></span><br><span class="line">short xShort = 0xaa</span><br><span class="line">assert xShort == 170 as short</span><br><span class="line"></span><br><span class="line">byte xByte = 0x3a</span><br><span class="line">assert xByte == 58 as byte</span><br><span class="line"></span><br><span class="line">long xLong = 0xffff</span><br><span class="line">assert xLong == 65535l</span><br><span class="line"></span><br><span class="line">BigInteger xBigInteger = 0xaaaa</span><br><span class="line">assert xBigInteger == 43690g</span><br><span class="line"></span><br><span class="line">Double xDouble = new Double(&apos;0x1.0p0&apos;)</span><br><span class="line">assert xDouble == 1.0d</span><br><span class="line"></span><br><span class="line">int xNegativeInt = -0x77</span><br><span class="line">assert xNegativeInt == -119</span><br></pre></td></tr></table></figure>
<h4 id="小数"><a href="#小数" class="headerlink" title="小数"></a>小数</h4><p>小数类型与Java一样：</p>
<ul>
<li>float</li>
<li>double</li>
<li>java.lang.BigDecimal</li>
</ul>
<p>你能采用如下定义方式创建这些类型的数字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// primitive types</span><br><span class="line">float f = 1.234</span><br><span class="line">double d = 2.345</span><br><span class="line"></span><br><span class="line">// infinite precision</span><br><span class="line">BigDecimal bd = 3.456</span><br></pre></td></tr></table></figure>
<p>小数能使用指数，使用e或E指数字母，紧跟着一个可选符号，且有一个整数表示指数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">assert 1e3 == 1_000.0</span><br><span class="line">assert 2E4 == 20_000.0</span><br><span class="line">assert 3e+1 == 30.0</span><br><span class="line">assert 4E-2 == 0.04</span><br><span class="line">assert 5e-1 == 0.5</span><br></pre></td></tr></table></figure>
<p>为了精确的进行小数计算，Groovy选择java.lang.BigDecimal作为小数类型。此外，float和double也被支持，但要求有一个显式类型定义，类型转换或后缀。即使BigDecimal是默认的小数，携带float或double作为类型参数的方法或闭包也可以接受这些数值。<br>小数不能使用二进制，八进制和十六进制表示。</p>
<h4 id="有下划线的文本"><a href="#有下划线的文本" class="headerlink" title="有下划线的文本"></a>有下划线的文本</h4><p>当写一个很长的数字，使用眼睛很难弄清楚有多少数字组合在一起，例如使用千，单词等组合。通过允许你在数字中添加一些下划线，更容易发现这些组合：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">long creditCardNumber = 1234_5678_9012_3456L</span><br><span class="line">long socialSecurityNumbers = 999_99_9999L</span><br><span class="line">double monetaryAmount = 12_345_132.12</span><br><span class="line">long hexBytes = 0xFF_EC_DE_5E</span><br><span class="line">long hexWords = 0xFFEC_DE5E</span><br><span class="line">long maxLong = 0x7fff_ffff_ffff_ffffL</span><br><span class="line">long alsoMaxLong = 9_223_372_036_854_775_807L</span><br><span class="line">long bytes = 0b11010010_01101001_10010100_10010010</span><br></pre></td></tr></table></figure>
<h4 id="数字类型后缀"><a href="#数字类型后缀" class="headerlink" title="数字类型后缀"></a>数字类型后缀</h4><p>通过使用大写或小写类型后缀（见下表），我们能强制将一个数字（包括二进制，八进制，十六进制）给一个指定类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Type            Suffix</span><br><span class="line">BigInteger      G 或 g</span><br><span class="line">Long            L 或 l</span><br><span class="line">Integer         I 或 i</span><br><span class="line">BigDecimal      G 或 g</span><br><span class="line">Double          D 或 d</span><br><span class="line">Float           F 或 f</span><br></pre></td></tr></table></figure>
<p>如:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">assert 42I == new Integer(&apos;42&apos;)</span><br><span class="line">assert 42i == new Integer(&apos;42&apos;) // lowercase i more readable</span><br><span class="line">assert 123L == new Long(&quot;123&quot;) // uppercase L more readable</span><br><span class="line">assert 2147483648 == new Long(&apos;2147483648&apos;) // Long type used, value too large for an Integer</span><br><span class="line">assert 456G == new BigInteger(&apos;456&apos;)</span><br><span class="line">assert 456g == new BigInteger(&apos;456&apos;)</span><br><span class="line">assert 123.45 == new BigDecimal(&apos;123.45&apos;) // default BigDecimal type used</span><br><span class="line">assert 1.200065D == new Double(&apos;1.200065&apos;)</span><br><span class="line">assert 1.234F == new Float(&apos;1.234&apos;)</span><br><span class="line">assert 1.23E23D == new Double(&apos;1.23E23&apos;)</span><br><span class="line">assert 0b1111L.class == Long // binary</span><br><span class="line">assert 0xFFi.class == Integer // hexadecimal</span><br><span class="line">assert 034G.class == BigInteger // octal</span><br></pre></td></tr></table></figure>
<h4 id="数学运算"><a href="#数学运算" class="headerlink" title="数学运算"></a>数学运算</h4><p>尽管运算在以后会被覆盖，讨论数学运算和结果类型仍然是重要的。<br>除法与幂方二元操作符放在一边（下文讨论）。</p>
<ul>
<li>byte char short和int进行二元操作的结果是int</li>
<li>使用long与byte char short int进行二元操作的结果是long</li>
<li>使用BigInteger与任意其他整数类型进行二元操作结果是BigInteger</li>
<li>float double与BigDecimal进行二元运算的结果是double</li>
<li>两个BigDecimal进行二元运算的结果是BigDecimal</li>
<li>下表总结了这些原则：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">        byte    char    short    int    long    BigInteger    float      double    BigDecimal</span><br><span class="line">byte    int     int     int      int    long    BigInteger    double     double    double</span><br><span class="line">char            int     int      int    long    BigInteger    double     double    double</span><br><span class="line">short                   int      int    long    BigInteger    double     double    double</span><br><span class="line">int                              int    long    BigInteger    double     double    double</span><br><span class="line">long                                    long    BigInteger    double     double    double</span><br><span class="line">BigInteger                                      BigInteger    double     double    double</span><br><span class="line">float                                                         double     double    double</span><br><span class="line">double                                                                   double    double</span><br><span class="line">BigDecimal                                                                         BigDecimal</span><br></pre></td></tr></table></figure>
<p>由于Groovy操作符重载，BigInteger与BigDecimal通常也能进行运算操作，与Java不同，在Java中你不得不显式使用方法操作这些数字。</p>
<h5 id="除法运算符的情况"><a href="#除法运算符的情况" class="headerlink" title="除法运算符的情况"></a>除法运算符的情况</h5><p>如果任何一个操作数是float或double,那么除法运算符/(和/= 用于除法和赋值)产生double结果，否则（当两个操作数是一个与整型类型short, char, byte, int, long, BigInteger or BigDecimal的任意组合）是一个BigDecimal结果。</p>
<p>如果除法是精确的（如，结果可以在相同的精度和标度范围内精确表示），那么BigDecimal的除法实际执行的是divide()方法，或使用两个操作数的最大精度加10,和一个最大值为10的标度的MathContext。</p>
<p>对于整数除法和Java相同，你应该使用intdiv()方法，因为Groovy没有专门提供一个整数操作符。</p>
<h5 id="幂运算情况"><a href="#幂运算情况" class="headerlink" title="幂运算情况"></a>幂运算情况</h5><p>幂运算操作符使用**操作符，有两个参数：基数和指数。幂运算的结果取决于它的操作数以及操作的结果（特别是结果可以被表示为一个整数值）。</p>
<p>以下这些原则被用于决定Groovy幂运算操作结果的类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">（1）如果指数是一个小数</span><br><span class="line">	1.如果结果能作为一个Integer表示，那么返回一个Integer</span><br><span class="line">	2..如果结果能作为一个Long表示，那么返回一个Long</span><br><span class="line">	3.否则返回一个Double</span><br><span class="line"></span><br><span class="line">（2）如果指数是一个整数</span><br><span class="line"> 	1.如果是一个严格的负数，那么返回一个Integer，Long或Double，结果值使用那种类型填充。</span><br><span class="line">        2.如果指数是正数或0</span><br><span class="line"> 	  1)如果基数是BigDecimal，那么返回一个BigDecimal结果值</span><br><span class="line">	  2)如果基数是BigInteger，那么返回一个BigInteger结果值</span><br><span class="line">	  3)如果基数是Integer，那么返回一个Integer值，否则返回BigInteger</span><br><span class="line">	  4)如果基数是Long，那么返回一个Long值，否则返回BigInteger</span><br></pre></td></tr></table></figure>
<p>我们使用一些实例说明这些原则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// base and exponent are ints and the result can be represented by an Integer</span><br><span class="line">assert 2 ** 3 instanceof Integer // 8</span><br><span class="line">assert 10 ** 9 instanceof Integer // 1_000_000_000</span><br><span class="line"></span><br><span class="line">// the base is a long, so fit the result in a Long</span><br><span class="line">// (although it could have fit in an Integer)</span><br><span class="line">assert 5L ** 2 instanceof Long // 25</span><br><span class="line"></span><br><span class="line">// the result can&apos;t be represented as an Integer or Long, so return a BigInteger</span><br><span class="line">assert 100 ** 10 instanceof BigInteger // 10e20</span><br><span class="line">assert 1234 ** 123 instanceof BigInteger // 170515806212727042875...</span><br><span class="line"></span><br><span class="line">// the base is a BigDecimal and the exponent a negative int</span><br><span class="line">// but the result can be represented as an Integer</span><br><span class="line">assert 0.5 ** -2 instanceof Integer // 4</span><br><span class="line"></span><br><span class="line">// the base is an int, and the exponent a negative float</span><br><span class="line">// but again, the result can be represented as an Integer</span><br><span class="line">assert 1 ** -0.3f instanceof Integer // 1</span><br><span class="line"></span><br><span class="line">// the base is an int, and the exponent a negative int</span><br><span class="line">// but the result will be calculated as a Double</span><br><span class="line">// (both base and exponent are actually converted to doubles)</span><br><span class="line">assert 10 ** -1 instanceof Double // 0.1</span><br><span class="line"></span><br><span class="line">// the base is a BigDecimal, and the exponent is an int, so return a BigDecimal</span><br><span class="line">assert 1.2 ** 10 instanceof BigDecimal // 6.1917364224</span><br><span class="line"></span><br><span class="line">// the base is a float or double, and the exponent is an int</span><br><span class="line">// but the result can only be represented as a Double value</span><br><span class="line">assert 3.4f ** 5 instanceof Double // 454.35430372146965</span><br><span class="line">assert 5.6d ** 2 instanceof Double // 31.359999999999996</span><br><span class="line"></span><br><span class="line">// the exponent is a decimal value</span><br><span class="line">// and the result can only be represented as a Double value</span><br><span class="line">assert 7.8 ** 1.9 instanceof Double // 49.542708423868476</span><br><span class="line">assert 2 ** 0.1f instanceof Double // 1.0717734636432956</span><br></pre></td></tr></table></figure>
<h4 id="布尔"><a href="#布尔" class="headerlink" title="布尔"></a>布尔</h4><p>Boolean是一种特殊的数据类型，用于表示真值：true和false。使用这种数据类型作为跟踪真假条件的简单标志。</p>
<p>Boolean能被存储在变量中，成员变量中，就像其他数据类型一样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def myBooleanVariable = true</span><br><span class="line">boolean untypedBooleanVar = false</span><br><span class="line">booleanField = true</span><br></pre></td></tr></table></figure>
<p>true和false是仅有的两个原始布尔值。但更复杂的布尔表达式能使用逻辑操作符表示。</p>
<p>除此之外，Groovy有一些特殊的规则（经常因为Groovy真值涉及）用于将非布尔值对象转化为一个布尔值。</p>
<h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><p>Groovy使用逗号分隔列表中的值，并使用方括号包围，用来指定一个列表。Groovy的列表是java.util.List，因为Groovy没有定义任何集合类。当定义一个列表常量时，默认的列表具体实现是java.util.ArrayList，除非你指定，我们将在后面看到。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def numbers = [1, 2, 3] （1）</span><br><span class="line"></span><br><span class="line">assert numbers instanceof List （2）</span><br><span class="line">assert numbers.size() == 3 （3）</span><br></pre></td></tr></table></figure>
<p>（1）我们定义用逗号分隔，并用方括号包围列表数字，并将列表赋值给一个变量</p>
<p>（2）list是java java.util.List接口的实例</p>
<p>（3）列表的大小可以使用size()方法查询，表明列表有三个元素</p>
<p>在上面的示例中，我们使用了一个元素类型相同的列表，我们也能创建包含不同类型元素的列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def heterogeneous = [1, &quot;a&quot;, true] （1）</span><br></pre></td></tr></table></figure>
<p>（1）我们的列表包含一个数字，一个字符串，一个布尔值</p>
<p>我们提及到，默认的列表字面量实际是java.util.ArrayList的实例，但列表使用不同返回类型也是可以的，使用as操作符进行类型转换，或使用变量的定义类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def arrayList = [1, 2, 3]</span><br><span class="line">assert arrayList instanceof java.util.ArrayList</span><br><span class="line"></span><br><span class="line">def linkedList = [2, 3, 4] as LinkedList （1）</span><br><span class="line">assert linkedList instanceof java.util.LinkedList</span><br><span class="line"></span><br><span class="line">LinkedList otherLinked = [3, 4, 5] （2）</span><br><span class="line">assert otherLinked instanceof java.util.LinkedList</span><br></pre></td></tr></table></figure>
<p>（1）我们使用as操作符进行类型转换，显式请求一个java.util.LinkedList实现<br>（2）我们使用类型为java.util.LinkedList的变量保存列表字面量</p>
<p>你能通过下标操作符<code>[](读和写元素值)</code>并使用正索引值访问列表元素或负索引值从列表尾部访问元素，也可以使用范围，或使用左移&lt;&lt;追加列表元素：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">def letters = [&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;]</span><br><span class="line"></span><br><span class="line">assert letters[0] == &apos;a&apos; （1）</span><br><span class="line">assert letters[1] == &apos;b&apos;</span><br><span class="line"></span><br><span class="line">assert letters[-1] == &apos;d&apos; （2）</span><br><span class="line">assert letters[-2] == &apos;c&apos;</span><br><span class="line"></span><br><span class="line">letters[2] = &apos;C&apos; （3）</span><br><span class="line">assert letters[2] == &apos;C&apos;</span><br><span class="line"></span><br><span class="line">letters &lt;&lt; &apos;e&apos; （4）</span><br><span class="line">assert letters[ 4] == &apos;e&apos;</span><br><span class="line">assert letters[-1] == &apos;e&apos;</span><br><span class="line"></span><br><span class="line">assert letters[1, 3] == [&apos;b&apos;, &apos;d&apos;] （5）</span><br><span class="line">assert letters[2..4] == [&apos;C&apos;, &apos;d&apos;, &apos;e&apos;] （6）</span><br></pre></td></tr></table></figure>
<p>（1）访问列表的第一个元素（索引从零开始计算）</p>
<p>（2）使用负索引访问列表的最后一个元素：-1是列表从尾部开始的第一个元素</p>
<p>（3）使用赋值操作为列表的第三个元素设置一个新值</p>
<p>（4）使用&lt;&lt;左移操作符在列表尾部追加一个元素</p>
<p>（5）一次访问两个元素，并返回一个包含这两个元素的新列表</p>
<p>（6）使用范围访问列表中这个范围内的元素，从start到end元素位置</p>
<p>因为列表可以很自然的做到元素类型不同，因此列表也可以包含列表用于创建多维列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def multi = [[0, 1], [2, 3]] （1）</span><br><span class="line">assert multi[1][0] == 2 （2）</span><br></pre></td></tr></table></figure>
<p>（1）定义一个数字列表的列表</p>
<p>（2）访问顶级列表的第二个元素，内部列表的第一个元素</p>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>Groovy使用列表标记来标记数组，但为了创建字面量数组，你需要通过类型转换或类型定义来定义数组类型。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String[] arrStr = [&apos;Ananas&apos;, &apos;Banana&apos;, &apos;Kiwi&apos;] （1）</span><br><span class="line"></span><br><span class="line">assert arrStr instanceof String[] （2）</span><br><span class="line">assert !(arrStr instanceof List)</span><br><span class="line"></span><br><span class="line">def numArr = [1, 2, 3] as int[] （3）</span><br><span class="line"></span><br><span class="line">assert numArr instanceof int[] （4）</span><br><span class="line">assert numArr.size() == 3</span><br></pre></td></tr></table></figure>
<p>（1）使用显式变量类型定义一个字符串数组</p>
<p>（2）断言说明我们创建了一个字符串数组</p>
<p>（3）使用as操作符创建以int数组</p>
<p>（4）断言表明我们创建了一个原始类型的int数组</p>
<p>你也能创建多维数组：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def matrix3 = new Integer[3][3] （1）</span><br><span class="line">assert matrix3.size() == 3</span><br><span class="line"></span><br><span class="line">Integer[][] matrix2 （2）</span><br><span class="line">matrix2 = [[1, 2], [3, 4]]</span><br><span class="line">assert matrix2 instanceof Integer[][]</span><br></pre></td></tr></table></figure>
<p>（1）你能定义一个新数组的边界</p>
<p>（2）或不指定它的边界定义一个新数组</p>
<p>通过与列表相同的标记访问数组的元素：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String[] names = [&apos;Cédric&apos;, &apos;Guillaume&apos;, &apos;Jochen&apos;, &apos;Paul&apos;]</span><br><span class="line">assert names[0] == &apos;Cédric&apos; （1）</span><br><span class="line"></span><br><span class="line">names[2] = &apos;Blackdrag&apos; （2）</span><br><span class="line">assert names[2] == &apos;Blackdrag&apos;</span><br></pre></td></tr></table></figure>
<p>（1）取得数组的第一个元素</p>
<p>（2）为数组的第三个元素设置一个新值</p>
<p>Java数组初始化标记Groovy不支持，因为大括号会被误解为Groovy的闭包标记。</p>
<h3 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h3><p>在其它语言中，有时候称为字典或关联数组，Groovy称为映射。映射使键到值关联，使用冒号将键值分隔开，每个键值对使用逗号，整个键和值使用方括号包围。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def colors = [red: &apos;#FF0000&apos;, green: &apos;#00FF00&apos;, blue: &apos;#0000FF&apos;] （1）</span><br><span class="line"></span><br><span class="line">assert colors[&apos;red&apos;] == &apos;#FF0000&apos; （2）</span><br><span class="line">assert colors.green == &apos;#00FF00&apos; （3）</span><br><span class="line"></span><br><span class="line">colors[&apos;pink&apos;] = &apos;#FF00FF&apos; （4）</span><br><span class="line">colors.yellow = &apos;#FFFF00&apos; （5）</span><br><span class="line"></span><br><span class="line">assert colors.pink == &apos;#FF00FF&apos;</span><br><span class="line">assert colors[&apos;yellow&apos;] == &apos;#FFFF00&apos;</span><br><span class="line"></span><br><span class="line">assert colors instanceof java.util.LinkedHashMap</span><br></pre></td></tr></table></figure>
<p> (1）我们定义了一个字符串颜色名关联十六进制的html颜色的映射</p>
<p>（2）我们使用下标标记检查red键值关联的内容</p>
<p>（3）我们也能使用属性标记访问绿颜色十六进制表达式</p>
<p>（4）相似的，我们也能使用下标标记添加一个新的键值对</p>
<p>（5）或者使用属性标记添加yellow颜色</p>
<p>当使用这些键的名字时，我们实际上在映射中定义了一个键值。<br>Groovy创建的映射实际是java.util.LinkedHashMap的实例。</p>
<p>如果你尝试在映射中访问不存在的键：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert colors.unknown == null</span><br></pre></td></tr></table></figure>
<p>你将取回null。</p>
<p>在上面的示例中我们使用字符串键值，你也可以使用其他类型作为键值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def numbers = [1: &apos;one&apos;, 2: &apos;two&apos;]</span><br><span class="line"></span><br><span class="line">assert numbers[1] == &apos;one&apos;</span><br></pre></td></tr></table></figure>
<p>这里我们使用数字作为键值，作为数字能清楚的识别数字，因此Groovy不会像之前的示例一样创建一个字符串的键。但是考虑你想传递一个变量代替键的情况下，有一个变量值将会作为键：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">def key = &apos;name&apos;</span><br><span class="line">def person = [key: &apos;Guillaume&apos;] （1）</span><br><span class="line"></span><br><span class="line">assert !person.containsKey(&apos;name&apos;) （2）</span><br><span class="line">assert person.containsKey(&apos;key&apos;) （3）</span><br></pre></td></tr></table></figure>
<p>（1）key同’Guillaume’关联，名字将会变为”key”字符串，而不是其值</p>
<p>（2）这个映射不包括”name”键</p>
<p>（3）代替的是，映射包括一个”key”键</p>
<p>你也能通过引用的字符串以及键: [“name”: “Guillaume”]。如果你的见字符串不是一个合法的标识符，这是强制的，例如，如果你想创建一个字符串键像哈希：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&quot;street-name&quot;: &quot;Main street&quot;]。</span><br></pre></td></tr></table></figure>
<p>在映射定义中需要传递变量值，你必须使用圆括号包围这个变量或表达式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">person = [(key): &apos;Guillaume&apos;] （1）</span><br><span class="line"></span><br><span class="line">assert person.containsKey(&apos;name&apos;) （2）</span><br><span class="line">assert !person.containsKey(&apos;key&apos;) （3）</span><br></pre></td></tr></table></figure>
<p>（1）这次，我们使用圆括号包围key变量，指示解析器我们传递一个变量，而不是定义一个字符串键</p>
<p>（2）映射包含name键</p>
<p>（3）但映射不像之前包含key键</p>
<h2 id="Groovy-函数与闭包"><a href="#Groovy-函数与闭包" class="headerlink" title="Groovy 函数与闭包"></a>Groovy 函数与闭包</h2><h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>有些人可能对函数和方法的叫法一直不太清楚。事实上没有本质区别，在面向过程的语言中一般称为函数，在函数式编程中一般都叫做函数。方法的一般是类的方法，在某一个类中定义的称之为方法。</p>
<p>在Groovy中除非指定了确定的返回类型，void也可以作为返回值的一种，否则定义函数必须加上关键字def。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">String getString()&#123;</span><br><span class="line">    return &quot;hello world&quot;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">def getDef()&#123;</span><br><span class="line">    return &quot;hello world&quot;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">void printSomething()&#123;</span><br><span class="line">    println &quot;hello worlld&quot;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//错误的定义，编译可以通过，但是运行时报错</span><br><span class="line">//getString()&#123;</span><br><span class="line">//    return &quot;hello world&quot;</span><br><span class="line">//&#125;</span><br></pre></td></tr></table></figure>
<p>在定义函数需要传参时可以不设置设置参数的类型，默认是Object类型的，如果用def关键字设置参数类型，事实上也是使用的Object定义参数的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">def printSomething01(param)&#123;</span><br><span class="line">    println param</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">def printSomething02(int param)&#123;</span><br><span class="line">    println param</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">def printSomething03(def param)&#123;</span><br><span class="line">    println param</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在调用函数时，如果所定义的函数有参数，在使用的时候可以不使用括号，但是必须得传入参数，参数与函数名以空格隔开。</p>
<p>如果不出入参数必须添加括号，否则代码编译可以通过，但是运行时会出错，会将函数误认为是一个属性。</p>
<p>如果所定义的函数没有参数，在调用的时候必须添加括号，否则运行出错，会将函数误认为是一个属性。</p>
<p>函数调用的时候参数的个数必须匹配，否则也会报错，提示没有定义该函数，如果单个参数除外，可以不用输入参数，系统默认赋值null。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">def printSomething(param01,param02)&#123;</span><br><span class="line">    println param01+param02</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printSomething (&quot;hello&quot;,&quot;world&quot;)//helloworld</span><br><span class="line">printSomething &quot;hello&quot;,&quot;world&quot;//helloworld</span><br><span class="line"></span><br><span class="line">//参数个数不对，报错</span><br><span class="line">//printSomething (&quot;hello&quot;)</span><br><span class="line"></span><br><span class="line">def printOne(param)&#123;</span><br><span class="line">    println param</span><br><span class="line">&#125;</span><br><span class="line">printOne()//null</span><br></pre></td></tr></table></figure>
<p>函数可以有返回值，如果有显示地使用return关键字，则返回return指定的返回值，其后面的语句不再执行。</p>
<p>如果没有显式地使用return关键字，则返回函数最后一行语句的运行结果。</p>
<p>如果使用void关键字代替def关键字定义函数，则函数的返回值将为null。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">def printSomething()&#123;</span><br><span class="line">    return &quot;hello&quot;</span><br><span class="line">    println &quot;world&quot;</span><br><span class="line">&#125;</span><br><span class="line">println printSomething()//hello</span><br><span class="line"> </span><br><span class="line">def printSomething01()&#123;</span><br><span class="line">    &quot;hello world&quot;</span><br><span class="line">    1</span><br><span class="line">&#125;</span><br><span class="line">println printSomething01()//1</span><br><span class="line"> </span><br><span class="line">def printSomething02()&#123;</span><br><span class="line">    1</span><br><span class="line">    &quot;hello world&quot;</span><br><span class="line">&#125;</span><br><span class="line">println printSomething02()//hello world</span><br></pre></td></tr></table></figure>
<p>支持函数重载，当参数个数不同时，函数名称可以同名。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def printSomething(param)&#123;</span><br><span class="line">    println param</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">def printSomething(param01,param02)&#123;</span><br><span class="line">    println param01+&quot; &quot;+param02</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">printSomething(&quot;hello&quot;)</span><br><span class="line">printSomething(&quot;hello&quot;,&quot;world&quot;)</span><br></pre></td></tr></table></figure>
<p>函数内不可以访问函数外的变量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">int m=1</span><br><span class="line">def n=&quot;hello&quot;</span><br><span class="line">//error</span><br><span class="line">def printSomething()&#123;</span><br><span class="line">    println m//error</span><br><span class="line">    println n//error</span><br><span class="line">&#125;</span><br><span class="line">printSomething()</span><br></pre></td></tr></table></figure>
<p>Groovy支持不定长参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def printSomething(... params) &#123;</span><br><span class="line">    println(params[0])</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">printSomething(&quot;hello&quot;)</span><br><span class="line">printSomething(&quot;hello&quot;,&quot;world&quot;)</span><br></pre></td></tr></table></figure>
<p>函数可以赋值给其它函数，使用语法标记&amp;将函数赋予新的函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def printSomething() &#123;</span><br><span class="line">    println(&quot;hello world&quot;)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">//printSomething不可以加括号</span><br><span class="line">def printHello=this.&amp;printSomething</span><br><span class="line"> </span><br><span class="line">printHello()          //hello world</span><br><span class="line">printSomething()      //hello world</span><br></pre></td></tr></table></figure>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><p>Groovy中闭包是这么定义的:可以用作函数参数和方法参数的代码块。可以把这个代码块理解为一个函数指针。</p>
<p>闭包的定义格式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def xxx = &#123; params -&gt; code &#125;</span><br><span class="line">//或者</span><br><span class="line">def xxx=&#123;code&#125;</span><br></pre></td></tr></table></figure>
<p>闭包可以访问外部的变量，记住一点方法是不能访问外部变量的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">def str=&quot;hello world&quot;</span><br><span class="line"> </span><br><span class="line">def closure=&#123;</span><br><span class="line">    println str</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">closure()//hello world</span><br></pre></td></tr></table></figure>
<p>闭包是有返回值的，默认最后一行语句就是该闭包的返回值，如果最后一行语句没有不输入任何类型，闭包将返回null。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">def closure = &#123;</span><br><span class="line">    println &quot;hello world&quot;</span><br><span class="line">    return &quot;I&apos;m callback&quot;</span><br><span class="line">&#125;</span><br><span class="line">//hello world</span><br><span class="line">//I&apos;m callback</span><br><span class="line">println closure()</span><br><span class="line"> </span><br><span class="line">def noReturn=&#123;</span><br><span class="line">    println &quot;hello world&quot;</span><br><span class="line">&#125;</span><br><span class="line">//hello world</span><br><span class="line">//null</span><br><span class="line">println noReturn()</span><br></pre></td></tr></table></figure>
<p>闭包可以有参数，如果没有定义参数，会有一个隐式的默认参数it，如果没有参数可以将[参数]和[-&gt;]省略。</p>
<p>如果存在参数，在[-&gt;]之前的就是参数，如果只有一个参数，参数可以省略。</p>
<p>闭包中参数名称不能与闭包内或闭包外的参数名重名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def closure=&#123;</span><br><span class="line">    println &quot;hello $it&quot;</span><br><span class="line">&#125;</span><br><span class="line">closure(&quot;admin&quot;)</span><br><span class="line"> </span><br><span class="line">def closure=&#123;</span><br><span class="line">    param01,param02,param03-&gt;println param01+param02+param03</span><br><span class="line">&#125;</span><br><span class="line">closure &quot;hello&quot;,&quot;world&quot;,&quot;ok&quot;</span><br><span class="line"> </span><br><span class="line">def closure=&#123;</span><br><span class="line">    println it</span><br><span class="line">&#125;</span><br><span class="line">closure &quot;hello world&quot;</span><br><span class="line"> </span><br><span class="line">//编译时就不通过</span><br><span class="line">//def param</span><br><span class="line">//def closure=&#123;</span><br><span class="line">//    param-&gt;println param</span><br><span class="line">//&#125;</span><br></pre></td></tr></table></figure>
<p>闭包可以作为一个参数传递给另一个闭包，也可以在闭包中返回一个闭包。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">def toTriple = &#123; n -&gt; n * 3 &#125;</span><br><span class="line">def runTwice = &#123; a, c -&gt; c(c(a)) &#125;</span><br><span class="line">println runTwice(5, toTriple)//45</span><br><span class="line"> </span><br><span class="line">def times = &#123; x -&gt; &#123; y -&gt; x * y &#125; &#125;</span><br><span class="line">println times(3)(4)//12</span><br></pre></td></tr></table></figure>
<p>闭包的一些快捷写法，当闭包作为闭包或方法的最后一个参数，可以将闭包从参数圆括号中提取出来接在最后。</p>
<p>如果闭包中不包含闭包，则闭包或方法参数所在的圆括号也可以省略。</p>
<p>对于有多个闭包参数的，只要是在参数声明最后的，均可以按上述方式省略。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def runTwice = &#123; a, c -&gt; c(c(a)) &#125;</span><br><span class="line">println runTwice(5, &#123; it * 3 &#125;) //45 usual syntax</span><br><span class="line">println runTwice(5) &#123; it * 3 &#125; //45</span><br><span class="line"> </span><br><span class="line">def closure = &#123;</span><br><span class="line">    param -&gt; println param</span><br><span class="line">&#125;</span><br><span class="line">closure &quot;hello world&quot;</span><br><span class="line"> </span><br><span class="line">def runTwoClosures = &#123; a, c1, c2 -&gt; c1(c2(a)) &#125;</span><br><span class="line">//when more than one closure as last params</span><br><span class="line">assert runTwoClosures(5, &#123; it * 3 &#125;, &#123; it * 4 &#125;) == 60 //usual syntax</span><br><span class="line">assert runTwoClosures(5) &#123; it * 3 &#125; &#123; it * 4 &#125; == 60 //shortcut form</span><br></pre></td></tr></table></figure>
<p>闭包接受参数的规则，会将参数列表中所有有键值关系的参数，作为一个map组装，传入闭包作为调用闭包的第一个参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def f= &#123;m, i, j-&gt; i + j + m.x + m.y &#125;</span><br><span class="line">println f(6, x:4, y:3, 7)//20</span><br></pre></td></tr></table></figure>
<p>如果闭包的参数声明中没有list，那么传入参数可以设置为list，里面的参数将分别传入闭包参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def c = &#123; a, b, c -&gt; a + b + c &#125;</span><br><span class="line">def list = [1, 2, 3]</span><br><span class="line">println c(list) // 6</span><br></pre></td></tr></table></figure>
<h2 id="Groovy-类与对象"><a href="#Groovy-类与对象" class="headerlink" title="Groovy 类与对象"></a>Groovy 类与对象</h2><p>Groovy类与Java类似，在字节码级都被编译成Java类，由于其在定义变量上面的灵活性，所以在新建一个Groovy类时还是有一些不同的，增加了许多灵活性。由于Groovy是松散型语言，它并不强制你给属性、方法参数和返回值定义类型。如果没有指定类型，在字节码级别会被编译成Object。在定义类的属性时不用刻意加上权限修饰符，默认就是public的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">class Book&#123;</span><br><span class="line">    def title</span><br><span class="line">    String author</span><br><span class="line">	private int price</span><br><span class="line">	</span><br><span class="line">    public Book(title)&#123;</span><br><span class="line">        this.title=title</span><br><span class="line">    &#125;</span><br><span class="line">    boolean order(int isbn)&#123;</span><br><span class="line">        true</span><br><span class="line">    &#125;</span><br><span class="line">    def title()&#123;</span><br><span class="line">        &quot;Booke Title&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Book book=new Book(&quot;Hello Groovy&quot;)</span><br><span class="line">book.order(1001)</span><br><span class="line"></span><br><span class="line">book.title//获取属性</span><br><span class="line">book.title()//访问方法</span><br></pre></td></tr></table></figure>
<p>如果我们将Book类看做是一个JavaBean，事实上Groovy在编译完成后会自动帮助我们生成getter与setter方法，但是私有属性除外也就是说price属性我们不能使用getter与setter方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Book book=new Book(&quot;Hello Groovy&quot;)</span><br><span class="line">println book.getTitle()//Hello Groovy</span><br><span class="line"> </span><br><span class="line">book.setTitle(&quot;New Groovy&quot;)</span><br><span class="line">println book.getTitle()//New Groovy</span><br><span class="line"> </span><br><span class="line">println book.title////New Groovy</span><br></pre></td></tr></table></figure>
<p>在Groovy中类名和文件名并不需要严格的映射关系，我们知道在Java中主类名必须与文件同名，但是在Groovy中一个文件可以定义多个public类。<br>在Groovy中可以定义与任何类不相关的方法和语句，这些方法通常称为独立方法或者松方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class Hello&#123;</span><br><span class="line">    public static String hello()&#123;</span><br><span class="line">        return &quot;hello&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class World&#123;</span><br><span class="line">    public static String world()&#123;</span><br><span class="line">        return &quot;world&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">println Hello.hello()+World.world()</span><br><span class="line"> </span><br><span class="line">def helloWorld()&#123;</span><br><span class="line">	return &quot;hello world&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面一个文件名定义为Structure.groovy，在这个文件中包含了类的定义和独立方法声明，它编译之后会发生什么呢。首先会生成一个与文件同名的class文件。所有的松语句都集中在run方法中，并且run方法被该类的main方法调用。独立方法被编译成了类的静态方法。与Java相似，每一个独立的类都会被编译成一个单独的class文件。因此编译Structure.groovy文件最后会被编译成Hello.class、World.class和Structure.class。上面一个文件名定义为Structure.groovy，在这个文件中包含了类的定义和独立方法声明，它编译之后会发生什么呢。首先会生成一个与文件同名的class文件。所有的松语句都集中在run方法中，并且run方法被该类的main方法调用。独立方法被编译成了类的静态方法。与Java相似，每一个独立的类都会被编译成一个单独的class文件。因此编译Structure.groovy文件最后会被编译成Hello.class、World.class和Structure.class。</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="http://www.sunnyang.com/522.html" target="_blank" rel="external">Groovy进阶之函数、闭包和类</a><br><a href="http://ifeve.com/groovy-syntax/" target="_blank" rel="external">《Groovy语言规范》-语法</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/gradle/" rel="tag"># gradle</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/08/19/gradle-study-1/" rel="next" title="Gradle for Andoid 学习笔记(一):Gradle基础">
                <i class="fa fa-chevron-left"></i> Gradle for Andoid 学习笔记(一):Gradle基础
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/08/26/windowmanager-keyevent/" rel="prev" title="WindowManager悬浮窗如何监听Home键和返回键">
                WindowManager悬浮窗如何监听Home键和返回键 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2016/08/24/gradle-study-2/"
     data-title="Gradle for Andoid 学习笔记(二):Groovy入门"
     data-content=""
     data-url="http://czhzero.com/2016/08/24/gradle-study-2/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>

          
          </div>
          

  <p>热评文章</p>
  <div class="ds-top-threads" data-range="weekly" data-num-items="4"></div>


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/08/24/gradle-study-2/"
           data-title="Gradle for Andoid 学习笔记(二):Groovy入门" data-url="http://czhzero.com/2016/08/24/gradle-study-2/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/my_head.jpeg"
               alt="Alvin-一座小楼" />
          <p class="site-author-name" itemprop="name">Alvin-一座小楼</p>
          <p class="site-description motion-element" itemprop="description">大海从不拒绝走过弯路的小溪</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">61</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">44</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/czhzero" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/1765185530" target="_blank" title="微博">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  微博
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Groovy是什么"><span class="nav-number">1.</span> <span class="nav-text">Groovy是什么</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基础语法"><span class="nav-number">2.</span> <span class="nav-text">基础语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#注释"><span class="nav-number">2.1.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关键字"><span class="nav-number">2.2.</span> <span class="nav-text">关键字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#标识符"><span class="nav-number">2.3.</span> <span class="nav-text">标识符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#正常标识符"><span class="nav-number">2.3.1.</span> <span class="nav-text">正常标识符</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#引用标识符"><span class="nav-number">2.3.2.</span> <span class="nav-text">引用标识符</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串"><span class="nav-number">2.4.</span> <span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#单引号字符串"><span class="nav-number">2.4.1.</span> <span class="nav-text">单引号字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字符串连接"><span class="nav-number">2.4.2.</span> <span class="nav-text">字符串连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#三单引号字符串"><span class="nav-number">2.4.3.</span> <span class="nav-text">三单引号字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#转义特殊字符"><span class="nav-number">2.4.3.1.</span> <span class="nav-text">转义特殊字符</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Unicode转义序列"><span class="nav-number">2.4.3.2.</span> <span class="nav-text">Unicode转义序列</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#双引号字符串"><span class="nav-number">2.4.4.</span> <span class="nav-text">双引号字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#字符串插值"><span class="nav-number">2.4.4.1.</span> <span class="nav-text">字符串插值</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#插入闭包表达式的特殊情况"><span class="nav-number">2.4.5.</span> <span class="nav-text">插入闭包表达式的特殊情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#与Java的互操作性"><span class="nav-number">2.4.6.</span> <span class="nav-text">与Java的互操作性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GString和String的hashCode"><span class="nav-number">2.4.7.</span> <span class="nav-text">GString和String的hashCode</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三双引号字符串"><span class="nav-number">2.5.</span> <span class="nav-text">三双引号字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#斜杠字符串"><span class="nav-number">2.6.</span> <span class="nav-text">斜杠字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#美元符修饰的斜杠字符串"><span class="nav-number">2.6.1.</span> <span class="nav-text">美元符修饰的斜杠字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字符串总结表"><span class="nav-number">2.6.2.</span> <span class="nav-text">字符串总结表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字符"><span class="nav-number">2.6.3.</span> <span class="nav-text">字符</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数字"><span class="nav-number">2.7.</span> <span class="nav-text">数字</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#整数"><span class="nav-number">2.7.1.</span> <span class="nav-text">整数</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#可选择的非十进制表示"><span class="nav-number">2.7.1.1.</span> <span class="nav-text">可选择的非十进制表示</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#小数"><span class="nav-number">2.7.2.</span> <span class="nav-text">小数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#有下划线的文本"><span class="nav-number">2.7.3.</span> <span class="nav-text">有下划线的文本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数字类型后缀"><span class="nav-number">2.7.4.</span> <span class="nav-text">数字类型后缀</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数学运算"><span class="nav-number">2.7.5.</span> <span class="nav-text">数学运算</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#除法运算符的情况"><span class="nav-number">2.7.5.1.</span> <span class="nav-text">除法运算符的情况</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#幂运算情况"><span class="nav-number">2.7.5.2.</span> <span class="nav-text">幂运算情况</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#布尔"><span class="nav-number">2.7.6.</span> <span class="nav-text">布尔</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#列表"><span class="nav-number">2.7.7.</span> <span class="nav-text">列表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组"><span class="nav-number">2.8.</span> <span class="nav-text">数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#映射"><span class="nav-number">2.9.</span> <span class="nav-text">映射</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Groovy-函数与闭包"><span class="nav-number">3.</span> <span class="nav-text">Groovy 函数与闭包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#函数"><span class="nav-number">3.1.</span> <span class="nav-text">函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#闭包"><span class="nav-number">3.2.</span> <span class="nav-text">闭包</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Groovy-类与对象"><span class="nav-number">4.</span> <span class="nav-text">Groovy 类与对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考文献"><span class="nav-number">5.</span> <span class="nav-text">参考文献</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Alvin-一座小楼</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"czhzero"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js?v=5.1.0"></script>
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  












  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("bWQ0bNnPvEx2cikhn5zECb2z-gzGzoHsz", "MT29shr3Wj61Uz3y31too94a");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
